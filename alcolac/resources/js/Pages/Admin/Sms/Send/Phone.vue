<template>
    <div class="message-preview-phone">
        <div id="message-preview-from-title" class="_2lVU5">ALC</div>
        <svg width="272" height="529" viewBox="0 0 272 529">
            <g id="phone_svg__Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="phone_svg__phone" transform="translate(1)"><g id="phone_svg__Group-2">
                    <g id="phone_svg__guy-phone">
                        <path d="M233.108.59H36.938C16.699.59.227 17.062.227
                        37.3v453.918c0 20.24 16.472 36.711 36.71 36.711h196.125c20.239
                        0 36.711-16.472 36.711-36.71V37.3c0-20.239-16.427-36.711-36.665-36.711z"
                              id="phone_svg__Path" stroke="#000" stroke-width="0.5"
                              fill="#353535" fill-rule="nonzero">
                        </path>
                        <path d="M36.938 526.568c-19.467 0-35.35-15.837-35.35-35.35V37.301c0-19.467
                        15.837-35.35 35.35-35.35h196.124c19.467 0 35.35 15.837 35.35 35.35v453.917c0
                        19.468-15.837 35.35-35.35 35.35H36.938z"
                              id="phone_svg__Path" stroke="#6D6D6D"
                              stroke-width="0.5" fill="#353535"
                              fill-rule="nonzero">
                        </path>
                        <path d="M36.938 522.03c-16.972 0-30.812-13.84-30.812-30.812V37.301c0-16.972
                        13.84-30.812 30.812-30.812h196.124c16.972 0 30.812 13.84 30.812 30.812l.227
                        453.917c0 16.972-14.067 30.812-31.039 30.812H36.938z" id="phone_svg__Path"
                              fill="#F8F7F7" fill-rule="nonzero"></path>
                        <path d="M245.042 19.286h-1.316v1.316h-11.118v-5.718h11.118v1.498h1.316v2.904zm-2.314-3.721h-4.583v4.13h4.583v-4.13z"
                              id="phone_svg__Shape" fill="#000" fill-rule="nonzero"></path>

                        <text id="phone_svg__TEL" fill="#000" font-family="Helvetica" font-size="9.076"
                              font-weight="normal"><tspan x="127" y="19.437">TEL</tspan>
                        </text>
                        <g id="phone_svg__Group" transform="translate(217.815 13.16)"
                           fill="#000" fill-rule="nonzero">
                            <path id="phone_svg__Rectangle" d="M7.124.272h2.314v7.714H7.124zM3.721
                            2.995h2.587v4.992H3.721zM.318 5.536h2.45v2.45H.318z">

                            </path>
                        </g>
                        <path d="M235.195 4.356h-4.946c19.694 0 35.667
                        15.973 35.667 35.668v-4.947c0-16.971-13.75-30.72-30.721-30.72zM34.669
                         524.345h4.946c-19.694 0-35.667-15.974-35.667-35.668v4.947c0 16.971 13.75
                          30.72 30.72 30.72z" id="phone_svg__Path"
                              fill="#898989" fill-rule="nonzero"></path>
                    </g>
                    <g id="phone_svg__Stickers" transform="translate(208 487)">
                        <path d="M7.26 0a7.26 7.26 0 110 14.521A7.26 7.26 0
                        017.26 0zm0 .66a6.6 6.6 0 100 13.201A6.6 6.6 0 007.26.66z"
                              id="phone_svg__Path" fill="#0781F0" fill-rule="nonzero">
                        </path>
                        <path d="M4.098 8.896s.958 1.917 3.187 1.913c2.229-.003 3.08-1.899 3.08-1.899"
                              id="phone_svg__Path" stroke="#0781F0" stroke-width="0.653">
                        </path>
                        <circle id="phone_svg__Path" stroke="#0781F0" stroke-width="0.5" fill="#0781F0"
                                fill-rule="nonzero" cx="9.175" cy="5.592" r="1">
                        </circle>
                        <circle id="phone_svg__Path" stroke="#0781F0" stroke-width="0.5"
                                fill="#0781F0" fill-rule="nonzero" cx="5.214" cy="5.592"
                                r="1">
                        </circle>
                    </g>
                    <path id="phone_svg__Plus" fill="#007AFF"
                          fill-rule="nonzero" d="M24.842 488v5.473H31v1.37l-6.158-.001V501h-1.368l-.001-6.158H18v-1.368l5.473-.001V488z">
                    </path>
                    <rect id="phone_svg__Chat-section" stroke="#DDD"
                          stroke-width="0.5" fill="#FFF" fill-rule="nonzero"
                          x="42.25" y="485.25" width="186.5" height="19.5" rx="9.75">

                    </rect>
                    <text id="phone_svg__Message" fill="#959596"
                          font-family="Helvetica" font-size="11.643"
                          font-weight="normal">
                        <tspan x="53" y="499">Message</tspan>
                    </text>
                    <text id="phone_svg__Y" fill="#FFF" font-family="Helvetica"
                          font-size="11.798" font-weight="normal">
                        <tspan x="225" y="180">Y</tspan>
                    </text>
                    <text id="phone_svg__Y" fill="#FFF"
                          font-family="Helvetica" font-size="11.798"
                          font-weight="normal">
                        <tspan x="222" y="210">Y</tspan>
                    </text><g id="phone_svg__Stickers"
                              transform="translate(235 487)">
                    <path d="M7.26 0a7.26 7.26 0 110 14.521A7.26 7.26 0 017.26
                         0zm0 .66a6.6 6.6 0 100 13.201A6.6 6.6 0 007.26.66z"
                          id="phone_svg__Path" fill="#0781F0" fill-rule="nonzero"></path>
                    <path d="M4.098 8.896s.958 1.917 3.187 1.913c2.229-.003
                        3.08-1.899 3.08-1.899" id="phone_svg__Path" stroke="#0781F0" stroke-width="0.653">
                    </path><circle id="phone_svg__Path" stroke="#0781F0" stroke-width="0.5"
                                   fill="#0781F0" fill-rule="nonzero" cx="9.175" cy="5.592" r="1">
                </circle>
                    <circle id="phone_svg__Path" stroke="#0781F0" stroke-width="0.5"
                            fill="#0781F0" fill-rule="nonzero" cx="5.214" cy="5.592" r="1">
                    </circle>
                </g>
                    <path id="phone_svg__Rectangle" fill="#FFF" fill-rule="nonzero" d="M6 59h258v413H6z">

                    </path></g></g></g>
        </svg>
        <div class="message-preview-container">
            <span id="message-preview" v-html="message"></span>
        </div>
    </div>
</template>

<script>
    export default {
        props: [
            'messagePreview',
            'type',
            'users',
            'group',
            'location'
        ],
        data() {
            return {
                message: ''
            }
        },
        watch: {
            messagePreview(val) {
                console.log(val);
                const instance = this;

                //TODO check why we are getting the wrong name returned
                this.$inertia.post('/admin/api/tag-builder', this.tagBuilder).then( () => {
                    instance.message = this.$parent.$parent.$props.data.builtMessage;
                })
            }
        },
        computed: {
            tagBuilder()
            {
                return {
                    message: this.messagePreview,
                    type: this.type,
                    users: this.users,
                    location: this.location,
                    group: this.group,
                }
            }
        }
    }
</script>
